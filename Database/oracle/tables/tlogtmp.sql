DROP TABLE ASU.TLOGTMP CASCADE CONSTRAINTS
/

--
-- TLOGTMP  (Table) 
--
CREATE TABLE ASU.TLOGTMP
(
  FK_ID         NUMBER(15)                      NOT NULL,
  FC_TABLE      VARCHAR2(32 BYTE),
  FC_FIELD      VARCHAR2(32 BYTE),
  FC_ACTION     VARCHAR2(6 BYTE),
  FC_OLD        VARCHAR2(255 BYTE),
  FC_NEW        VARCHAR2(255 BYTE),
  FC_OSUSER     VARCHAR2(32 BYTE),
  FC_MACHINE    VARCHAR2(32 BYTE),
  FC_TERMINAL   VARCHAR2(32 BYTE),
  FC_MODULE     VARCHAR2(100 BYTE),
  FC_OSFORM     VARCHAR2(32 BYTE),
  FN_USERID     NUMBER(15),
  FD_LOGONTIME  DATE,
  FC_PROCESS    VARCHAR2(15 BYTE),
  FK_OWNER      NUMBER
)
TABLESPACE USR
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
NOLOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING
/

COMMENT ON TABLE ASU.TLOGTMP IS 'Таблица слежения за работой людей  by Kulechek'
/

COMMENT ON COLUMN ASU.TLOGTMP.FK_ID IS 'SEQUENCE=[SEQ_TLOG]'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_TABLE IS 'таблица'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_FIELD IS 'поле'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_ACTION IS 'действие'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_OLD IS 'старое значение'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_NEW IS 'новое значение'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_OSUSER IS 'пользователь ОС'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_MACHINE IS 'терминала'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_TERMINAL IS 'название терминала'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_MODULE IS 'программный модуль'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_OSFORM IS 'активная форма'
/

COMMENT ON COLUMN ASU.TLOGTMP.FN_USERID IS 'TSOTR.FK_ID'
/

COMMENT ON COLUMN ASU.TLOGTMP.FD_LOGONTIME IS 'время записи'
/

COMMENT ON COLUMN ASU.TLOGTMP.FC_PROCESS IS 'процесс ИД'
/

COMMENT ON COLUMN ASU.TLOGTMP.FK_OWNER IS 'Ссылка на родительский FK_ID'
/


--
-- TLOGTMP_BEFORE_INSERT  (Trigger) 
--
--  Dependencies: 
--   TLOGTMP (Table)
--
CREATE OR REPLACE TRIGGER ASU."TLOGTMP_BEFORE_INSERT" 
 BEFORE
 INSERT
 ON ASU.TLOGTMP  REFERENCING OLD AS OLD NEW AS NEW
 FOR EACH ROW
begin
    SELECT SEQ_TLOG.NEXTVAL INTO :NEW.FK_ID FROM DUAL;
end;
/
SHOW ERRORS;


