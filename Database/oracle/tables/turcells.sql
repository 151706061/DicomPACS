DROP TABLE ASU.TURCELLS CASCADE CONSTRAINTS
/

--
-- TURCELLS  (Table) 
--
CREATE TABLE ASU.TURCELLS
(
  FK_ID        NUMBER(9)                        DEFAULT -1,
  FK_REPORTID  NUMBER(9)                        DEFAULT -1,
  FC_NAME      VARCHAR2(50 BYTE),
  FN_ROW       NUMBER(3),
  FN_COL       NUMBER(3),
  FC_FUNC      VARCHAR2(100 BYTE)
)
TABLESPACE USR
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          160K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING
/

COMMENT ON TABLE ASU.TURCELLS IS 'Описание ячеек для универсального отчета'
/

COMMENT ON COLUMN ASU.TURCELLS.FK_ID IS 'SEQUENCE=[SEQ_TURCELLS]'
/

COMMENT ON COLUMN ASU.TURCELLS.FK_REPORTID IS 'TUREPORTS->FK_ID'
/

COMMENT ON COLUMN ASU.TURCELLS.FC_NAME IS 'Наиманование'
/

COMMENT ON COLUMN ASU.TURCELLS.FN_ROW IS 'Нормер строки'
/

COMMENT ON COLUMN ASU.TURCELLS.FN_COL IS 'Номер столбца'
/

COMMENT ON COLUMN ASU.TURCELLS.FC_FUNC IS 'Функция...'
/


--
-- TURCELLS_BEFORE_INSERT  (Trigger) 
--
--  Dependencies: 
--   TURCELLS (Table)
--
CREATE OR REPLACE TRIGGER ASU."TURCELLS_BEFORE_INSERT" 
BEFORE  INSERT  ON ASU.TURCELLS REFERENCING
 NEW AS NEW
 OLD AS OLD
FOR EACH ROW
Begin
  SELECT SEQ_TURCELLS.NEXTVAL INTO :NEW.FK_ID FROM DUAL;
End;
/
SHOW ERRORS;


--
-- TURCELLS_BEFORE_DELETE  (Trigger) 
--
--  Dependencies: 
--   TURCELLS (Table)
--
CREATE OR REPLACE TRIGGER ASU."TURCELLS_BEFORE_DELETE" 
AFTER  DELETE  ON ASU.TURCELLS REFERENCING
 NEW AS NEW
 OLD AS OLD
FOR EACH ROW
Begin
  DELETE FROM TURALGO WHERE FK_CELLID=:OLD.FK_ID;
End;
/
SHOW ERRORS;


