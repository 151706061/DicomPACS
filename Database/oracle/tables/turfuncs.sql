DROP TABLE ASU.TURFUNCS CASCADE CONSTRAINTS
/

--
-- TURFUNCS  (Table) 
--
CREATE TABLE ASU.TURFUNCS
(
  FK_ID       NUMBER(9)                         DEFAULT -1,
  FC_SHOW     VARCHAR2(100 BYTE),
  FC_NAME     VARCHAR2(200 BYTE),
  FL_ENABLED  NUMBER(1)                         DEFAULT 1
)
TABLESPACE USR
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          160K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING
/

COMMENT ON TABLE ASU.TURFUNCS IS 'Справочник функций для универсального отчета'
/

COMMENT ON COLUMN ASU.TURFUNCS.FK_ID IS 'SEQUENCE=[SEQ_TURFUNCS]'
/

COMMENT ON COLUMN ASU.TURFUNCS.FC_SHOW IS 'Название по русски'
/

COMMENT ON COLUMN ASU.TURFUNCS.FC_NAME IS 'Реальное имя'
/

COMMENT ON COLUMN ASU.TURFUNCS.FL_ENABLED IS 'Доступна-ли функция?'
/


--
-- TURFUNCS_BEFORE_INSERT  (Trigger) 
--
--  Dependencies: 
--   TURFUNCS (Table)
--
CREATE OR REPLACE TRIGGER ASU."TURFUNCS_BEFORE_INSERT" 
BEFORE INSERT
ON ASU.TURFUNCS REFERENCING OLD AS OLD NEW AS NEW
FOR EACH ROW
Begin
  SELECT SEQ_TURFUNCS.NEXTVAL INTO :NEW.FK_ID FROM DUAL;
End;
/
SHOW ERRORS;


--
-- TURFUNCS_BEFORE_DELETE  (Trigger) 
--
--  Dependencies: 
--   TURFUNCS (Table)
--
CREATE OR REPLACE TRIGGER ASU."TURFUNCS_BEFORE_DELETE" 
AFTER DELETE
ON ASU.TURFUNCS REFERENCING OLD AS OLD NEW AS NEW
FOR EACH ROW
Begin
  DELETE FROM TURFUNCSPARAMS WHERE FK_FUNCID=:OLD.FK_ID;
  DELETE FROM TURALGO WHERE FK_FUNCID=:OLD.FK_ID;
End;
/
SHOW ERRORS;


